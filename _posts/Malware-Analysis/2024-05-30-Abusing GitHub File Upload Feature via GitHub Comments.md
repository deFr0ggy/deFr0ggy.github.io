---
title: "Abusing GitHub File Upload Feature via GitHub Comments"
classes: wide
header:
  teaser:  /assets/images/GitHubTeaser.png
ribbon: red
description: "GitHub has a functionality of uploading files when you create comments in repositories which can be abused by the threat actors due to the nature how it works."
categories:
  - Research
tags:
  - Research
toc: true
---

# Initials

I have been reading a lot about this abuse which is related to GitHub Comments where adversaries are using Comments Feature to upload malicious binaries/malwares/droppers via well known repositories, `Microsoft` GitHub repository was in the limeline as `RedLine Stealer` was being spread under `Cheats` for the gaming community. 

This stealer was linked to 2 Microsoft Official GitHub repositories. 

- https://github.com/microsoft/vcpkg
- https://github.com/microsoft/STL

# How it works

So, by reading the articles it looks like this is a default functionality of GitHub. This happens when anyone tries to create a comment on a GitHub Repository. Lets see it in action as below. 

I have taken the below screenshot from the McAfee Research Article linked below in the references. 

![McAfee Research](https://www.mcafee.com/blogs/wp-content/uploads/2024/04/3.jpg)

It can clearly be seen that when the user tries to upload/attach the document into the Issues/Comments or anywhere where GitHub allows to upload files, it always took the name of the user who owns that repository. 

While this should have been true for the case where the owner/author of the repo is trying to upload the document. This was the case with the contributors as well. 

However, just by taking another look, it looks like GitHub has removed this functionality i.e. taking the name of the owner and then linking it to the attachment. 

In the below screenshots, i have tried to upload the file named `Malicious.zip`.

![](/assets/GitHubComments/2.png)

In the below screenshot, the file is uploaded successfully. 

![](/assets/GitHubComments/1.png)

So, using this link, it is possible to download the file. What happens when the owner of the repo or the contributor deletes the comments/issues etc. 

The file remains on the GitHub CDN. 

![](/assets/GitHubComments/4.png)

In the articles, it was mentioned when we try to upload the image files, they are moved into the `/assets` directory which remains true for now as well. 

![](/assets/GitHubComments/6.png)

However, the same is not the case for uploading ZIP files. 

While on trying to upload an `exe` file directory we are blessed with the filetype check. 

![](/assets/GitHubComments/7.png)

# Conclusion

So what we devise from all this is, there was a potential success factory when adversaries were able to host malicious files on these well known repositories as that increases the chances of success. 

However, thats limited as GitHub is moving everything under `user-attachments`. 

However, it is still required to have full visibility on the following URL on wildcard basis as now you don't have to look into every other repoitory which exists on the GitHub. 

Adversaries will still be exploiting this functionality as every other developer uses GitHub so definitely they will have right accesses opened in the environemnt to access GitHub and its related URLs. 

# What To Monitor

Teams should be monitoring the following URL at bare minimum to ensure what is being downloaded ethically or unethically. 

> https://github.com/user-attachments/*

# References

- https://www.mcafee.com/blogs/other-blogs/mcafee-labs/redline-stealer-a-novel-approach/

- https://www.bleepingcomputer.com/news/security/github-comments-abused-to-push-malware-via-microsoft-repo-urls/
